% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/spacexr.R
\name{run.RCTD}
\alias{run.RCTD}
\title{Run RCTD algorithm to decompose cell type mixtures}
\usage{
run.RCTD(RCTD, doublet_mode = "doublet")
}
\arguments{
\item{RCTD}{\code{\linkS4class{RCTD}} object created using
\code{\link{create.RCTD}}}

\item{doublet_mode}{character string specifying the RCTD mode: "doublet",
"multi", or "full" (default: "doublet")}
}
\value{
A SummarizedExperiment object containing the RCTD results with:
  \itemize{
    \item Three assays (one in full mode):
      \itemize{
        \item \code{weights}: Cell type proportions restricted according to
        the specified mode (not available in full mode)
        \item \code{weights_unconfident}: Cell type proportions restricted
        according to the specified mode, including unconfident predictions
        (not available in full mode)
        \item \code{weights_full}: Unrestricted cell type proportions
      }
    \item rowData containing:
      \itemize{
        \item \code{x}, \code{y}: Spatial coordinates for each pixel
        \item For doublet mode:
          \itemize{
            \item \code{spot_class}: Classification as "singlet",
            "doublet_certain", "doublet_uncertain", or "reject"
            \item \code{first_type}, \code{second_type}: Predicted cell types
            \item \code{first_class}, \code{second_class}: Whether
            predictions were made at the class level
            \item Additional metrics like \code{min_score},
            \code{singlet_score}
          }
        \item For multi mode:
          \itemize{
            \item \code{cell_type_list}: List of cell types per pixel
            \item \code{conf_list}: List of whether cell type predictions
            are confident
            \item Additional metrics like \code{min_score}
          }
      }
  }
}
\description{
Runs the RCTD algorithm to decompose cell type mixtures in spatial
transcriptomics data. The algorithm has three modes:
\itemize{
  \item \code{doublet}: Fits at most two cell types per pixel and classifies
    each pixel as a "singlet" or "doublet." Recommended for high spatial
    resolution technologies such as Slide-seq or MERFISH.
  \item \code{multi}: Uses a greedy algorithm to fit cell types up to a fixed
    maximum number. Recommended for low spatial resolution technologies such
    as 100-micron resolution Visium.
  \item \code{full}: Can fit any number of cell types on each pixel.
}
}
\examples{
data(rctd_simulation)

# Spatial transcriptomics data
library(SpatialExperiment)
spatial_spe <- SpatialExperiment(
    assay = rctd_simulation$spatial_rna_counts,
    spatialCoords = rctd_simulation$spatial_rna_coords
)

# Reference data
library(SummarizedExperiment)
reference_se <- SummarizedExperiment(
    assays = list(counts = rctd_simulation$reference_counts),
    colData = rctd_simulation$reference_cell_types
)

# Create RCTD configuration
rctd <- create.RCTD(spatial_spe, reference_se, max_cores = 1)
rctd_se <- run.RCTD(rctd, doublet_mode = "doublet")

# Access the cell type proportions
head(assay(rctd_se, "weights"))

# Check spot classifications for doublet mode
head(rowData(rctd_se)$spot_class)

}
