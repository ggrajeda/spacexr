% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/RCTDreplicates.R
\name{run.RCTD.replicates}
\alias{run.RCTD.replicates}
\title{Runs the RCTD pipeline on a \code{\linkS4class{RCTD.replicates}} object}
\usage{
run.RCTD.replicates(RCTD.replicates, doublet_mode = "doublet")
}
\arguments{
\item{RCTD.replicates}{an \code{\linkS4class{RCTD.replicates}} object created using the \code{\link{create.RCTD.replicates}} function.}

\item{doublet_mode}{\code{character string}, either "doublet", "multi", or "full" on which mode to run RCTD. Please see above description.}
}
\value{
an \code{\linkS4class{RCTD.replicates}} object containing the results of the RCTD algorithm. Please see \code{\linkS4class{RCTD.replicates}}
and \code{\linkS4class{RCTD}} documentation for more information on interpreting the content of this object.
}
\description{
For each \code{\linkS4class{SpatialRNA}} replicate in the \code{RCTD.replicates} object, runs the \code{\link{run.RCTD}}
function to assign cell types.
}
\details{
If in doublet mode, fits at most two cell types per pixel. It classifies each pixel as 'singlet' or 'doublet' and searches for the cell types
on the pixel. If in full mode, can fit any number of cell types on each pixel. In multi mode, cell types are added using a greedy algorithm,
up to a fixed number.
}
\examples{
set.seed(123456789)
data(rctd_simulation)

reference <- Reference(
    rctd_simulation$reference_counts,
    rctd_simulation$reference_cell_types
)

num_genes <- nrow(rctd_simulation$spatial_rna_counts)
num_pixels <- ncol(rctd_simulation$spatial_rna_counts)

noise1 <- replicate(num_pixels, rpois(num_genes, lambda = 0.1))
spatial_rna1 <- SpatialRNA(
    rctd_simulation$spatial_rna_coords,
    rctd_simulation$spatial_rna_counts + noise1
)

noise2 <- replicate(num_pixels, rpois(num_genes, lambda = 0.1))
spatial_rna2 <- SpatialRNA(
    rctd_simulation$spatial_rna_coords,
    rctd_simulation$spatial_rna_counts + noise2
)

spatial_rna_replicates <- list(sr1 = spatial_rna1, sr2 = spatial_rna2)
rctd_replicates <- create.RCTD.replicates(
    spatial_rna_replicates,
    reference,
    names(spatial_rna_replicates)
)

rctd_replicates <- run.RCTD.replicates(
    rctd_replicates,
    doublet_mode = "doublet"
)

first_result <- results(RCTD.reps(rctd_replicates)[[1]])
head(first_result$results_df)

}
