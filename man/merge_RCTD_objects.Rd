% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/RCTDreplicates.R
\name{merge_RCTD_objects}
\alias{merge_RCTD_objects}
\title{Creates an \code{\linkS4class{RCTD.replicates}} object across multiple \code{\linkS4class{RCTD}} objects}
\usage{
merge_RCTD_objects(RCTD.reps, replicate_names, group_ids = NULL)
}
\arguments{
\item{RCTD.reps}{a list of multiple \code{\linkS4class{RCTD}} objects to merge into one \code{\linkS4class{RCTD.replicates}} object.}

\item{replicate_names}{a \code{character} vector of names for each replicate provided in \code{RCTD.reps}}

\item{group_ids}{(default constant across replicates) a named integer vector (length number of replicates) containing the group id for each replicate.
Names represent the replicate names, and replicates of the same group will be expected to be more similar than
replicates across groups.}
}
\value{
an \code{\linkS4class{RCTD.replicates}} object, containing each \code{\linkS4class{RCTD}} object in \code{RCTD.reps}
}
\description{
Creates an \code{\linkS4class{RCTD.replicates}} object across multiple \code{\linkS4class{RCTD}} objects
}
\examples{
set.seed(123456789)
data(rctd_simulation)

reference <- Reference(
    rctd_simulation$reference_counts,
    rctd_simulation$reference_cell_types
)

num_genes <- nrow(rctd_simulation$spatial_rna_counts)
num_pixels <- ncol(rctd_simulation$spatial_rna_counts)

noise1 <- replicate(num_pixels, rpois(num_genes, lambda = 0.1))
spatial_rna1 <- SpatialRNA(
    rctd_simulation$spatial_rna_coords,
    rctd_simulation$spatial_rna_counts + noise1
)
rctd1 <- create.RCTD(spatial_rna1, reference)

noise2 <- replicate(num_pixels, rpois(num_genes, lambda = 0.1))
spatial_rna2 <- SpatialRNA(
    rctd_simulation$spatial_rna_coords,
    rctd_simulation$spatial_rna_counts + noise2
)
rctd2 <- create.RCTD(spatial_rna2, reference)

rctds <- list(r1 = rctd1, r2 = rctd2)
rctd_replicates <- merge_RCTD_objects(rctds, names(rctds))

}
